<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë¹„ë²„ì±Œë¦°ì§€ ìœ ì „ì ë¬¸ì œ</title>
<style>
    body { font-family: Arial, sans-serif; background: #f8f9fa; margin: 20px; }
    .container { max-width: 900px; margin: auto; }
    .title { text-align: center; font-size: 24px; font-weight: bold; margin-bottom: 20px; }
    .box { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 3px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
    .story { background: #eef6ff; padding: 10px; border-left: 5px solid #007bff; margin-bottom: 15px; }
    table { border-collapse: collapse; margin: 10px 0; width: 100%; }
    table, th, td { border: 1px solid #ccc; }
    th, td { padding: 8px; text-align: center; }
    .activator { color: green; font-weight: bold; }
    .repressor { color: red; font-weight: bold; }
    .options label { display: block; padding: 8px; background: #e9ecef; margin: 5px 0; border-radius: 5px; cursor: pointer; }
    .options input { margin-right: 10px; }
    button { padding: 10px 15px; margin-top: 15px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #0056b3; }
    .result { margin-top: 15px; font-weight: bold; }
    .timer { font-weight: bold; font-size: 18px; color: #d9534f; text-align: right; }
    /* íŒì—… ìŠ¤íƒ€ì¼ */
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
             background: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
    .modal-content { background: white; padding: 20px; border-radius: 10px; text-align: center; }
    /* ë‚œì´ë„ë³„ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
.easy table { background: #f9fff9; }
.medium table { background: #f9f9ff; }
.hard table { 
    background: #fff9f9; 
    width: 100%;           /* í­ í™•ì¥ */
    font-size: 14px;       /* ê¸€ì”¨ í¬ê¸° ì¤„ì„ */
}
.hard table th, .hard table td {
    padding: 4px;          /* ê°„ê²© ì¤„ì´ê¸° */
}
</style>
</head>
<body>

<div class="container">
    <div class="title">ğŸ¦« ë¹„ë²„ì±Œë¦°ì§€ - ìœ ì „ì ë°œí˜„ ìŠ¤ìœ„ì¹˜</div>
    
    <!-- ìŠ¤í† ë¦¬ -->
    <div class="box">
        <div class="story">
            ğŸ§¬ <b>ë¹„ë²„ ì—°êµ¬ì†Œì˜ ì‹¤í—˜ ì¼ì§€</b><br>
            ë¹„ë²„ ê³¼í•™ì íŒ€ì€ ìƒˆë¡œìš´ í•©ì„± ìœ ì „ìë¥¼ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.  
            ê° ìœ ì „ìëŠ” íŠ¹ì • ì „ì‚¬ì¸ìê°€ ëª¨ë‘ ê²°í•©í•˜ê³  ì–µì œì¸ìê°€ ë°©í•´í•˜ì§€ ì•Šì„ ë•Œë§Œ ë‹¨ë°±ì§ˆì„ ë§Œë“­ë‹ˆë‹¤.  
            ì˜¤ëŠ˜, ì‹¤í—˜ ì¥ì¹˜ì— ì „ì‚¬ì¸ìì™€ ì–µì œì¸ìê°€ ì£¼ì–´ì¡Œì„ ë•Œ ì–´ë–¤ ìœ ì „ìê°€ ì¼œì§ˆì§€(ë°œí˜„ë ì§€) ì•Œì•„ë‚´ëŠ” ê²ƒì´ ë‹¹ì‹ ì˜ ì„ë¬´ì…ë‹ˆë‹¤.
        </div>
        <p><b>ê·œì¹™:</b> ì „ì‚¬ì¸ìê°€ ëª¨ë“  í•„ìš”í•œ ìë¦¬ì— ê²°í•©í•˜ê³ , ì–µì œì¸ìê°€ ê²°í•©í•˜ì§€ ì•Šìœ¼ë©´ ë°œí˜„ë©ë‹ˆë‹¤.</p>

        <!-- ë‚œì´ë„ + ì‹œê°„ ì„¤ì • -->
        <label for="difficulty">ë‚œì´ë„ ì„ íƒ:</label>
        <select id="difficulty">
            <option value="easy">ì‰¬ì›€</option>
            <option value="medium">ë³´í†µ</option>
            <option value="hard">ì–´ë ¤ì›€</option>
        </select>
        <br><br>
        <label for="timeSelect">ì‹œê°„ ì„ íƒ:</label>
        <select id="timeSelect">
            <option value="30">30ì´ˆ</option>
            <option value="60">1ë¶„</option>
            <option value="90">1ë¶„ 30ì´ˆ</option>
            <option value="120">2ë¶„</option>
        </select>
        <br><br>
        <button onclick="startQuiz()">ë¬¸ì œ í’€ê¸°</button>
    </div>

    <!-- ë¬¸ì œ ë°•ìŠ¤ -->
    <div class="box" id="questionBox" style="display:none;">
        <div class="timer" id="timer">ë‚¨ì€ ì‹œê°„: --</div>
        <div id="geneTable"></div>
        <p id="currentFactors"></p>
        <div class="options" id="optionsBox"></div>
        <button onclick="checkAnswer()">ì •ë‹µ í™•ì¸</button>
        <div class="result" id="result"></div>
        <button id="retryBtn" style="display:none;" onclick="retry()">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
    </div>
</div>

<!-- íŒì—… -->
<div class="modal" id="timeoutModal">
    <div class="modal-content">
        <h3>â³ ì‹œê°„ ì´ˆê³¼!</h3>
        <p>ë‹¤ì‹œ ë„ì „í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
        <button onclick="retry()">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
    </div>
</div>

<script>
let timerInterval;
let timeLeft;
let correctAnswer = "";
let genesData = [];

function startQuiz() {
    generateQuestion();
    document.getElementById("questionBox").style.display = "block";
    document.getElementById("retryBtn").style.display = "none";
    timeLeft = parseInt(document.getElementById("timeSelect").value);
    updateTimer();
    clearInterval(timerInterval);
    timerInterval = setInterval(countdown, 1000);
}

function updateTimer() {
    document.getElementById("timer").textContent = "ë‚¨ì€ ì‹œê°„: " + timeLeft + "ì´ˆ";
}

function countdown() {
    timeLeft--;
    updateTimer();
    if (timeLeft <= 0) {
        clearInterval(timerInterval);
        document.getElementById("timeoutModal").style.display = "flex";
    }
}

function generateQuestion() {
    let difficulty = document.getElementById("difficulty").value;
    let geneCount = difficulty === "easy" ? 3 : (difficulty === "medium" ? 5 : 7);
    let activators = ["X", "Y", "Z", "A", "B", "C"];
    let repressors = ["W", "Q", "R", "T", "M"];
    
    genesData = [];
    let activeActivators = activators.sort(() => 0.5 - Math.random()).slice(0, difficulty==="easy"?2: difficulty==="medium"?3:4);
    let activeRepressors = repressors.sort(() => 0.5 - Math.random()).slice(0, difficulty==="easy"?1: difficulty==="medium"?2:3);

    // ìœ ì „ì ëœë¤ ìƒì„±
    for (let i = 0; i < geneCount; i++) {
        let needAct = activators.sort(() => 0.5 - Math.random()).slice(0, difficulty==="easy"?1: difficulty==="medium"?2:3);
        let needRep = Math.random() > 0.5 ? [repressors[Math.floor(Math.random()*repressors.length)]] : [];
        genesData.push({
            name: "Gene" + (i+1),
            activators: needAct,
            repressors: needRep
        });
    }

    // í‘œ ë§Œë“¤ê¸° (ë‚œì´ë„ë³„ ìŠ¤íƒ€ì¼)
    let tableClass = difficulty === "easy" ? "easy" : difficulty === "medium" ? "medium" : "hard";
    let tableHTML = `<div class="${tableClass}"><table><tr><th>ìœ ì „ì</th><th>í•„ìš” ì „ì‚¬ì¸ì</th><th>ì–µì œì¸ì</th></tr>`;
    genesData.forEach(g => {
        tableHTML += `<tr><td>${g.name}</td>
                      <td>${g.activators.map(a=>`<span class='activator'>${a}</span>`).join(", ")}</td>
                      <td>${g.repressors.length>0?g.repressors.map(r=>`<span class='repressor'>${r}</span>`).join(", "):"(ì—†ìŒ)"}</td></tr>`;
    });
    tableHTML += `</table></div>`;
    document.getElementById("geneTable").innerHTML = tableHTML;

    // í˜„ì¬ í™œì„± ì¸ì í‘œì‹œ
    document.getElementById("currentFactors").innerHTML = `<b>í˜„ì¬ í™œì„± ì „ì‚¬ì¸ì:</b> ${activeActivators.join(", ")}<br>
                                                          <b>í˜„ì¬ í™œì„± ì–µì œì¸ì:</b> ${activeRepressors.join(", ")}`;

    // ì •ë‹µ ê³„ì‚°
    let activeGenes = genesData.filter(g => g.activators.every(a => activeActivators.includes(a)) && g.repressors.every(r => !activeRepressors.includes(r)));
    correctAnswer = activeGenes.map(g=>g.name).join(", ");

    // ì„ íƒì§€ ìƒì„±
    let optionsHTML = "";
    let distractors = [correctAnswer, "ì—†ìŒ", genesData.slice(0,2).map(g=>g.name).join(", "), genesData.slice(1,3).map(g=>g.name).join(", ")];
    distractors = [...new Set(distractors)];
    distractors.forEach((opt, idx) => {
        optionsHTML += `<label><input type="radio" name="answer" value="${opt}"> ${String.fromCharCode(65+idx)}) ${opt}</label>`;
    });
    document.getElementById("optionsBox").innerHTML = optionsHTML;
}

function checkAnswer() {
    let selected = document.querySelector('input[name="answer"]:checked');
    let resultDiv = document.getElementById("result");

    if (!selected) {
        resultDiv.textContent = "âš ï¸ ë‹µì„ ì„ íƒí•˜ì„¸ìš”.";
        resultDiv.style.color = "red";
        return;
    }

    if (selected.value === correctAnswer) {
        resultDiv.textContent = `âœ… ì •ë‹µ! ë°œí˜„ ìœ ì „ì: ${correctAnswer}`;
        resultDiv.style.color = "green";
        clearInterval(timerInterval); // íƒ€ì´ë¨¸ ë©ˆì¶¤
        document.getElementById("retryBtn").style.display = "inline-block";
    } else {
        resultDiv.textContent = "âŒ ì˜¤ë‹µì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.";
        resultDiv.style.color = "red";
    }
}

function retry() {
    document.getElementById("timeoutModal").style.display = "none";
    document.getElementById("result").textContent = "";
    document.querySelectorAll('input[name="answer"]').forEach(el => el.checked = false);
    document.getElementById("questionBox").style.display = "none";
}
</script>

</body>
</html>
